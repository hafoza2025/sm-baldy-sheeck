<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>๐๏ธ ููุญุฉ ุชุญูู ุงููุฏูุฑ - ูุธุงู ุงููุทุนู</title>
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/admin.css">
</head>
<body>
    <div class="header">
        <div>
            <h1>๐๏ธ ููุญุฉ ุชุญูู ุงููุฏูุฑ</h1>
            <span class="live-indicator"></span>
            <span style="font-size: 14px;">ูุจุงุดุฑ โข ูุญุธู</span>
        </div>
        <div class="user-info">
            <a href="inventory.html" class="btn btn-primary" style="margin-left: 15px; background: rgba(255,255,255,0.2); border: 2px solid white; padding: 8px 16px; border-radius: 6px; text-decoration: none; color: white; font-weight: 600;">
                ๐ณ ุฅุฏุงุฑุฉ Recipes
            </a>
            <a href="accounting.html" class="btn btn-primary" style="margin-left: 15px;">๐ผ ุงููุญุงุณุจุฉ</a>
            <span id="adminName">ูุฑุญุจุงูุ Admin</span>
            <button class="btn-logout" onclick="Auth.logout()">ุชุณุฌูู ุฎุฑูุฌ</button>
        </div>
    </div>

    <div class="container">
        <!-- ุงูุฅุญุตุงุฆูุงุช ุงูุฑุฆูุณูุฉ ุงููุญุธูุฉ -->
        <div class="stats-grid" style="margin-bottom: 30px;">
            <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
                <h3 style="color: rgba(255,255,255,0.9);">๐ฐ ุฅูุฑุงุฏุงุช ุงูููู</h3>
                <div class="value" style="color: white; font-size: 36px;" id="todayRevenue">0 ุฌููู</div>
                <div class="change" style="color: rgba(255,255,255,0.9); font-size: 13px;">
                    <span id="revenueChange">+0%</span> ุนู ุงูุฃูุณ
                </div>
            </div>

            <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: none;">
                <h3 style="color: rgba(255,255,255,0.9);">๐ ุทูุจุงุช ุงูููู</h3>
                <div class="value" style="color: white; font-size: 36px;" id="todayOrdersCount">0</div>
                <div class="change" style="color: rgba(255,255,255,0.9); font-size: 13px;">
                    ูุชูุณุท ุงููุงุชูุฑุฉ: <span id="avgOrderValue">0 ุฌููู</span>
                </div>
            </div>

            <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; border: none;">
                <h3 style="color: rgba(255,255,255,0.9);">๐ฅ ุทูุจุงุช ูุดุทุฉ ุงูุขู</h3>
                <div class="value" style="color: white; font-size: 36px;" id="activeOrders">0</div>
                <div class="change" style="color: rgba(255,255,255,0.9); font-size: 13px;">
                    ุฌุฏูุฏ: <span id="newOrders">0</span> โข ููุฏ ุงูุชุญุถูุฑ: <span id="preparingOrders">0</span>
                </div>
            </div>

            <div class="stat-card" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; border: none;">
                <h3 style="color: rgba(255,255,255,0.9);">๐ต ุตุงูู ุงูุฑุจุญ ุงูููู</h3>
                <div class="value" style="color: white; font-size: 36px;" id="todayProfit">0 ุฌููู</div>
                <div class="change" style="color: rgba(255,255,255,0.9); font-size: 13px;">
                    ูุงูุด: <span id="profitMargin">0%</span>
                </div>
            </div>
        </div>

        <!-- ุงููุจูุนุงุช ูุงูุชูุงููู -->
        <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="margin: 0; font-size: 20px;">๐ ููุฎุต ุงููุจูุนุงุช ูุงูุชูุงููู</h2>
                <div style="display: flex; gap: 10px;">
                    <button class="tab-btn active" onclick="AdminDashboard.setTimeFilter('today')" style="padding: 8px 16px; font-size: 14px;">ุงูููู</button>
                    <button class="tab-btn" onclick="AdminDashboard.setTimeFilter('week')" style="padding: 8px 16px; font-size: 14px;">ุงูุฃุณุจูุน</button>
                    <button class="tab-btn" onclick="AdminDashboard.setTimeFilter('month')" style="padding: 8px 16px; font-size: 14px;">ุงูุดูุฑ</button>
                </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                <div style="background: #f0f4ff; padding: 15px; border-radius: 8px; border-right: 4px solid #667eea;">
                    <div style="font-size: 13px; color: #666; margin-bottom: 5px;">ุฅุฌูุงูู ุงููุจูุนุงุช</div>
                    <div style="font-size: 24px; font-weight: bold; color: #667eea;" id="totalSales">0 ุฌููู</div>
                </div>
                <div style="background: #fff3f0; padding: 15px; border-radius: 8px; border-right: 4px solid #f44336;">
                    <div style="font-size: 13px; color: #666; margin-bottom: 5px;">ุชูููุฉ ุงูููููุงุช</div>
                    <div style="font-size: 24px; font-weight: bold; color: #f44336;" id="ingredientsCost">0 ุฌููู</div>
                </div>
                <div style="background: #f0fff4; padding: 15px; border-radius: 8px; border-right: 4px solid #4caf50;">
                    <div style="font-size: 13px; color: #666; margin-bottom: 5px;">ุตุงูู ุงูุฑุจุญ</div>
                    <div style="font-size: 24px; font-weight: bold; color: #4caf50;" id="netProfit">0 ุฌููู</div>
                </div>
                <div style="background: #fff9e6; padding: 15px; border-radius: 8px; border-right: 4px solid #ff9800;">
                    <div style="font-size: 13px; color: #666; margin-bottom: 5px;">ุงูุฎุณุงุฆุฑ</div>
                    <div style="font-size: 24px; font-weight: bold; color: #ff9800;" id="totalLosses">0 ุฌููู</div>
                </div>
            </div>
        </div>

        <!-- ุงููุฎุฒูู ูุงูุทูุจุงุช -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 20px;">
            <!-- ุญุงูุฉ ุงููุฎุฒูู -->
            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h2 style="margin: 0 0 20px 0; font-size: 18px;">๐ฆ ุญุงูุฉ ุงููุฎุฒูู</h2>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px;">
                    <div style="text-align: center; padding: 15px; background: #d4edda; border-radius: 8px;">
                        <div style="font-size: 32px; font-weight: bold; color: #155724;" id="stockAvailable">0</div>
                        <div style="font-size: 13px; color: #155724;">โ ูุชููุฑ</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: #fff3cd; border-radius: 8px;">
                        <div style="font-size: 32px; font-weight: bold; color: #856404;" id="stockLow">0</div>
                        <div style="font-size: 13px; color: #856404;">โ๏ธ ููุฎูุถ</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: #f8d7da; border-radius: 8px;">
                        <div style="font-size: 32px; font-weight: bold; color: #721c24;" id="stockCritical">0</div>
                        <div style="font-size: 13px; color: #721c24;">๐ด ุญุฑุฌ</div>
                    </div>
                </div>
                <div style="background: #f9f9f9; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 13px; color: #666; margin-bottom: 5px;">ูููุฉ ุงููุฎุฒูู ุงูุฅุฌูุงููุฉ</div>
                    <div style="font-size: 28px; font-weight: bold; color: #667eea;" id="inventoryValue">0 ุฌููู</div>
                </div>
                <div id="criticalItemsList" style="margin-top: 15px; max-height: 150px; overflow-y: auto;"></div>
            </div>

            <!-- ุฅุญุตุงุฆูุงุช ุงูุทูุจุงุช -->
            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h2 style="margin: 0 0 20px 0; font-size: 18px;">๐ ุชูุตูู ุงูุทูุจุงุช</h2>
                <div style="display: flex; flex-direction: column; gap: 12px;">
                    <div style="display: flex; justify-content: space-between; padding: 12px; background: #f0fff4; border-radius: 6px; border-right: 3px solid #4caf50;">
                        <span style="font-weight: 600;">โ ููุชููุฉ</span>
                        <span style="font-weight: bold; color: #4caf50;" id="completedOrders">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 12px; background: #fff3e0; border-radius: 6px; border-right: 3px solid #ff9800;">
                        <span style="font-weight: 600;">๐ ููุฏ ุงูุชุญุถูุฑ</span>
                        <span style="font-weight: bold; color: #ff9800;" id="preparingOrdersStat">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 12px; background: #e3f2fd; border-radius: 6px; border-right: 3px solid #2196f3;">
                        <span style="font-weight: 600;">๐ ุฌุฏูุฏุฉ</span>
                        <span style="font-weight: bold; color: #2196f3;" id="newOrdersStat">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 12px; background: #ffebee; border-radius: 6px; border-right: 3px solid #f44336;">
                        <span style="font-weight: 600;">โ ููุบุงุฉ</span>
                        <span style="font-weight: bold; color: #f44336;" id="cancelledOrders">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 12px; background: #f9f9f9; border-radius: 6px;">
                        <span style="font-weight: 600;">๐ฝ๏ธ ุฏุงุฎูู (Dine-in)</span>
                        <span style="font-weight: bold;" id="dineInOrders">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 12px; background: #f9f9f9; border-radius: 6px;">
                        <span style="font-weight: 600;">๐ต ุชูุตูู (Delivery)</span>
                        <span style="font-weight: bold;" id="deliveryOrders">0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ุงูุทุงููุงุช ูุงูุฏููููุฑู -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-bottom: 20px;">
            <!-- ุญุงูุฉ ุงูุทุงููุงุช -->
            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h2 style="margin: 0 0 20px 0; font-size: 18px;">๐ฝ๏ธ ุญุงูุฉ ุงูุทุงููุงุช</h2>
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 15px;">
                    <div style="text-align: center; padding: 12px; background: #d4edda; border-radius: 6px;">
                        <div style="font-size: 24px; font-weight: bold; color: #155724;" id="tablesAvailable">0</div>
                        <div style="font-size: 12px; color: #155724;">ูุชุงุญุฉ</div>
                    </div>
                    <div style="text-align: center; padding: 12px; background: #f8d7da; border-radius: 6px;">
                        <div style="font-size: 24px; font-weight: bold; color: #721c24;" id="tablesOccupied">0</div>
                        <div style="font-size: 12px; color: #721c24;">ูุดุบููุฉ</div>
                    </div>
                    <div style="text-align: center; padding: 12px; background: #fff3cd; border-radius: 6px;">
                        <div style="font-size: 24px; font-weight: bold; color: #856404;" id="tablesReserved">0</div>
                        <div style="font-size: 12px; color: #856404;">ูุญุฌูุฒุฉ</div>
                    </div>
                </div>
                <div style="background: #f9f9f9; padding: 12px; border-radius: 6px;">
                    <div style="font-size: 13px; color: #666; margin-bottom: 8px;">ูุณุจุฉ ุงูุฅุดุบุงู</div>
                    <div style="background: #e0e0e0; height: 20px; border-radius: 10px; overflow: hidden;">
                        <div id="occupancyBar" style="background: linear-gradient(90deg, #4caf50 0%, #ff9800 100%); height: 100%; width: 0%; transition: width 0.3s;"></div>
                    </div>
                    <div style="text-align: center; margin-top: 5px; font-weight: bold; font-size: 16px; color: #667eea;" id="occupancyRate">0%</div>
                </div>
            </div>

            <!-- ุญุงูุฉ ุงูุชูุตูู -->
            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h2 style="margin: 0 0 20px 0; font-size: 18px;">๐ต ุญุงูุฉ ุงูุชูุตูู</h2>
                <div style="display: flex; flex-direction: column; gap: 10px;">
                    <div style="display: flex; justify-content: space-between; padding: 10px; background: #fff3e0; border-radius: 6px;">
                        <span>ููุฏ ุงูุชุญุถูุฑ</span>
                        <span style="font-weight: bold;" id="deliveryPreparing">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 10px; background: #e3f2fd; border-radius: 6px;">
                        <span>ุฌุงูุฒ ููุชูุตูู</span>
                        <span style="font-weight: bold;" id="deliveryReady">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 10px; background: #fff9c4; border-radius: 6px;">
                        <span>ูู ุงูุทุฑูู</span>
                        <span style="font-weight: bold;" id="deliveryOnWay">0</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; padding: 10px; background: #d4edda; border-radius: 6px;">
                        <span>ุชู ุงูุชูุตูู ุงูููู</span>
                        <span style="font-weight: bold;" id="deliveryDelivered">0</span>
                    </div>
                </div>
                <div style="background: #f9f9f9; padding: 12px; border-radius: 6px; margin-top: 15px; text-align: center;">
                    <div style="font-size: 13px; color: #666; margin-bottom: 5px;">ูุชูุณุท ููุช ุงูุชูุตูู</div>
                    <div style="font-size: 24px; font-weight: bold; color: #667eea;" id="avgDeliveryTime">0 ุฏูููุฉ</div>
                </div>
            </div>

            <!-- ุฃูุซุฑ ุงูุฃุตูุงู ูุจูุนุงู -->
            <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <h2 style="margin: 0 0 20px 0; font-size: 18px;">๐ ุฃูุซุฑ ุงูุฃุตูุงู ูุจูุนุงู</h2>
                <div id="topSellingItems" style="display: flex; flex-direction: column; gap: 10px;"></div>
            </div>
        </div>

        <!-- ุงูุชุจููุจุงุช -->
        <div class="tabs">
            <button class="tab-btn active" onclick="AdminDashboard.switchTab('current')">ุงูุทูุจุงุช ุงูุญุงููุฉ</button>
            <button class="tab-btn" onclick="AdminDashboard.switchTab('orders')">ุฌููุน ุงูุทูุจุงุช</button>
            <button class="tab-btn" onclick="AdminDashboard.switchTab('users')">ุงููุณุชุฎุฏููู</button>
            <button class="tab-btn" onclick="AdminDashboard.switchTab('deliveries')">ุงูุชูุตูู</button>
            <button class="tab-btn" onclick="AdminDashboard.switchTab('inventory')">ุงููุฎุฒูู</button>
            <button class="tab-btn" onclick="AdminDashboard.switchTab('hr')">๐ฅ ุงูููุธููู</button>
            <button class="tab-btn" onclick="AdminDashboard.switchTab('expenses')">๐ฐ ุงููุตุฑููุงุช</button>
            <button class="tab-btn" onclick="AdminDashboard.switchTab('exports')">๐ ุงูุชูุงุฑูุฑ</button>
        </div>
        <!-- Current Orders Tab -->
        <div id="currentTab" class="tab-content active">
            <h2>ุงูุทูุจุงุช ุงูุญุงููุฉ</h2>
            <table>
                <thead>
                    <tr>
                        <th>ุฑูู ุงูุทูุจ</th>
                        <th>ุงูููุน</th>
                        <th>ุงูุทุงููุฉ/ุงูุนููู</th>
                        <th>ุงูุญุงูุฉ</th>
                        <th>ุงูุฅุฌูุงูู</th>
                        <th>ุงูููุช</th>
                    </tr>
                </thead>
                <tbody id="currentOrdersBody"></tbody>
            </table>
        </div>

        <!-- Orders Tab -->
        <div id="ordersTab" class="tab-content">
            <div class="filters">
                <input type="date" id="orderDateFrom" placeholder="ูู ุชุงุฑูุฎ">
                <input type="date" id="orderDateTo" placeholder="ุฅูู ุชุงุฑูุฎ">
                <select id="orderTypeFilter">
                    <option value="">ุฌููุน ุงูุฃููุงุน</option>
                    <option value="dine_in">ุฏุงุฎูู</option>
                    <option value="delivery">ุชูุตูู</option>
                </select>
                <select id="orderStatusFilter">
                    <option value="">ุฌููุน ุงูุญุงูุงุช</option>
                    <option value="new">ุฌุฏูุฏ</option>
                    <option value="preparing">ููุฏ ุงูุชุญุถูุฑ</option>
                    <option value="ready">ุฌุงูุฒ</option>
                    <option value="completed">ููุชูู</option>
                </select>
                <button class="btn btn-primary" onclick="AdminDashboard.filterOrders()">ุจุญุซ</button>
                <button class="btn btn-export" onclick="AdminDashboard.exportOrders()">ุชุตุฏูุฑ Excel</button>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>ุฑูู ุงูุทูุจ</th>
                        <th>ุงูุชุงุฑูุฎ</th>
                        <th>ุงูููุน</th>
                        <th>ุงูุทุงููุฉ/ุงูุนููู</th>
                        <th>ุงูููุธู</th>
                        <th>ุงูุฅุฌูุงูู</th>
                        <th>ุงูุญุงูุฉ</th>
                    </tr>
                </thead>
                <tbody id="ordersBody"></tbody>
            </table>
        </div>

        <!-- Users Tab -->
        <div id="usersTab" class="tab-content">
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="AdminDashboard.openAddUserModal()">โ ุฅุถุงูุฉ ูุณุชุฎุฏู</button>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>ุงูุงุณู</th>
                        <th>ุงุณู ุงููุณุชุฎุฏู</th>
                        <th>ุงูุฏูุฑ</th>
                        <th>ุงูููุจุงูู</th>
                        <th>ุงูุญุงูุฉ</th>
                        <th>ุงูุฅุฌุฑุงุกุงุช</th>
                    </tr>
                </thead>
                <tbody id="usersBody"></tbody>
            </table>
        </div>

        <!-- Deliveries Tab -->
        <div id="deliveriesTab" class="tab-content">
            <table>
                <thead>
                    <tr>
                        <th>ุฑูู ุงูุทูุจ</th>
                        <th>ุงุณู ุงูุนููู</th>
                        <th>ุงูููุจุงูู</th>
                        <th>ุงูุนููุงู</th>
                        <th>ุงูููุฏูุจ</th>
                        <th>ุฑุณูู ุงูุชูุตูู</th>
                        <th>ุงูุญุงูุฉ</th>
                        <th>ุงูููุช</th>
                    </tr>
                </thead>
                <tbody id="deliveriesBody"></tbody>
            </table>
        </div>

        <!-- Inventory Tab -->
        <div id="inventoryTab" class="tab-content">
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="window.location.href='inventory.html'">ุฅุฏุงุฑุฉ ุงููุฎุฒูู ุงููุงููุฉ</button>
                <button class="btn btn-export" onclick="AdminDashboard.exportInventory()">ุชุตุฏูุฑ Excel</button>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>ุงููููู</th>
                        <th>ุงููููุฉ ุงูุญุงููุฉ</th>
                        <th>ุงููุญุฏุฉ</th>
                        <th>ุงูุญุฏ ุงูุฃุฏูู</th>
                        <th>ุงูุชูููุฉ ููู ูุญุฏุฉ</th>
                        <th>ุงูุญุงูุฉ</th>
                    </tr>
                </thead>
                <tbody id="inventoryBody"></tbody>
            </table>
        </div>

        <!-- ========================================
             ูุณู ุฅุฏุงุฑุฉ ุงูููุธููู - ุฌุฏูุฏ
             ======================================== -->
        <div id="hrTab" class="tab-content">
            <h2 style="margin-bottom: 20px;">๐ฅ ุฅุฏุงุฑุฉ ุงูููุธููู ูุงูุญุถูุฑ</h2>

            <!-- Sub-tabs -->
            <div class="tabs" style="margin-bottom: 20px;">
                <button class="tab-btn active" onclick="switchHRSubTab('employees')">ุงูููุธููู</button>
                <button class="tab-btn" onclick="switchHRSubTab('attendance')">ุงูุญุถูุฑ ุงููููู</button>
                <button class="tab-btn" onclick="switchHRSubTab('salaries')">ุงูุฑูุงุชุจ</button>
            </div>

            <!-- ุชุจููุจ: ุงูููุธููู -->
            <div id="employees-subtab" class="tab-content active">
                <div class="action-buttons" style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="openAddEmployeeModal()">โ ุฅุถุงูุฉ ููุธู</button>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>ุงูุงุณู</th>
                            <th>ุงููุธููุฉ</th>
                            <th>ุงููุงุชู</th>
                            <th>ุงูุฑุงุชุจ ุงููููู</th>
                            <th>ุชุงุฑูุฎ ุงูุชุนููู</th>
                            <th>ุงูุญุงูุฉ</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="employeesBody"></tbody>
                </table>
            </div>

            <!-- ุชุจููุจ: ุงูุญุถูุฑ -->
            <div id="attendance-subtab" class="tab-content">
                <div style="background: white; padding: 20px; border-radius: 8px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3>ุชุณุฌูู ุงูุญุถูุฑ - <span id="attendance-date-display"></span></h3>
                        <input type="date" id="attendance-date-picker" class="form-input" style="width: 200px;">
                    </div>
                    <div id="attendance-list"></div>
                    <button class="btn btn-success" onclick="saveAttendance()" style="margin-top: 20px;">๐พ ุญูุธ ุงูุญุถูุฑ</button>
                </div>
            </div>

            <!-- ุชุจููุจ: ุงูุฑูุงุชุจ -->
            <div id="salaries-subtab" class="tab-content">
                <div style="background: white; padding: 20px; border-radius: 8px;">
                    <div style="display: flex; gap: 10px; margin-bottom: 20px; align-items: center;">
                        <input type="date" id="salary-from" class="form-input" placeholder="ูู">
                        <input type="date" id="salary-to" class="form-input" placeholder="ุฅูู">
                        <button class="btn btn-info" onclick="loadSalaryReport()">ุนุฑุถ ุงูุชูุฑูุฑ</button>
                        <button class="btn btn-success" onclick="exportSalariesExcel()">๐ ุชุตุฏูุฑ Excel</button>
                    </div>
                    <div id="salary-report"></div>
                </div>
            </div>
        </div>

        <!-- ========================================
             ูุณู ุงููุตุฑููุงุช ูุงูููุงุชูุฑ - ุฌุฏูุฏ
             ======================================== -->
        <div id="expensesTab" class="tab-content">
            <h2 style="margin-bottom: 20px;">๐ฐ ุฅุฏุงุฑุฉ ุงููุตุฑููุงุช ูุงูููุงุชูุฑ</h2>

            <!-- Sub-tabs -->
            <div class="tabs" style="margin-bottom: 20px;">
                <button class="tab-btn active" onclick="switchExpenseSubTab('suppliers')">ุงูููุฑุฏูู</button>
                <button class="tab-btn" onclick="switchExpenseSubTab('invoices')">ููุงุชูุฑ ุงูููุฑุฏูู</button>
                <button class="tab-btn" onclick="switchExpenseSubTab('general')">ุงููุตุฑููุงุช ุงูุนุงูุฉ</button>
            </div>

            <!-- ุชุจููุจ: ุงูููุฑุฏูู -->
            <div id="suppliers-subtab" class="tab-content active">
                <div class="action-buttons" style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="openAddSupplierModal()">โ ุฅุถุงูุฉ ููุฑุฏ</button>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>ุงูุงุณู</th>
                            <th>ุงููุงุชู</th>
                            <th>ุงููุฆุฉ</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="suppliersBody"></tbody>
                </table>
            </div>

            <!-- ุชุจููุจ: ููุงุชูุฑ ุงูููุฑุฏูู -->
            <div id="invoices-subtab" class="tab-content">
                <div class="action-buttons" style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="openAddInvoiceModal()">โ ุฅุถุงูุฉ ูุงุชูุฑุฉ</button>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>ุฑูู ุงููุงุชูุฑุฉ</th>
                            <th>ุงูููุฑุฏ</th>
                            <th>ุงูุชุงุฑูุฎ</th>
                            <th>ุงููุจูุบ</th>
                            <th>ุงููุฏููุน</th>
                            <th>ุงููุชุจูู</th>
                            <th>ุงูุญุงูุฉ</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="invoicesBody"></tbody>
                </table>
            </div>

            <!-- ุชุจููุจ: ุงููุตุฑููุงุช ุงูุนุงูุฉ -->
            <div id="general-subtab" class="tab-content">
                <div class="action-buttons" style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="openAddExpenseModal()">โ ุฅุถุงูุฉ ูุตุฑูู</button>
                    <button class="btn btn-export" onclick="exportExpensesExcel()">๐ ุชุตุฏูุฑ Excel</button>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>ุงูููุน</th>
                            <th>ุงูุชุงุฑูุฎ</th>
                            <th>ุงููุจูุบ</th>
                            <th>ุงููุฏููุน ุฅูู</th>
                            <th>ุงููุตู</th>
                            <th>ุงูุฅุฌุฑุงุกุงุช</th>
                        </tr>
                    </thead>
                    <tbody id="expensesBody"></tbody>
                </table>
            </div>
        </div>

        <!-- ========================================
             ูุณู ุชุตุฏูุฑ Excel - ุฌุฏูุฏ
             ======================================== -->
        <div id="exportsTab" class="tab-content">
            <h2 style="margin-bottom: 30px; text-align: center;">๐ ุชุตุฏูุฑ ุงูุชูุงุฑูุฑ ุงููุงููุฉ ุฅูู Excel</h2>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <!-- ุชุตุฏูุฑ ุงููุจูุนุงุช -->
                <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center;">
                    <div style="font-size: 48px; margin-bottom: 15px;">๐</div>
                    <h3 style="margin-bottom: 10px;">ุชูุฑูุฑ ุงููุจูุนุงุช</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 14px;">ุชุตุฏูุฑ ุชูุงุตูู ุงููุจูุนุงุช ูุน ุงูุฃุฑุจุงุญ ูุงูุชูุงููู</p>
                    <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px;">
                        <input type="date" id="sales-export-from" placeholder="ูู ุชุงุฑูุฎ" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                        <input type="date" id="sales-export-to" placeholder="ุฅูู ุชุงุฑูุฎ" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                    </div>
                    <button class="btn btn-success" onclick="exportSalesExcel()" style="width: 100%;">
                        ๐ ุชุตุฏูุฑ ุงููุจูุนุงุช
                    </button>
                </div>

                <!-- ุชุตุฏูุฑ ุงูุฑูุงุชุจ -->
                <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center;">
                    <div style="font-size: 48px; margin-bottom: 15px;">๐ฅ</div>
                    <h3 style="margin-bottom: 10px;">ุชูุฑูุฑ ุงูุฑูุงุชุจ</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 14px;">ุชุตุฏูุฑ ุฑูุงุชุจ ุงูููุธููู ูุน ุงูุญุถูุฑ ูุงูุบูุงุจ</p>
                    <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px;">
                        <input type="date" id="salary-export-from" placeholder="ูู ุชุงุฑูุฎ" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                        <input type="date" id="salary-export-to" placeholder="ุฅูู ุชุงุฑูุฎ" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                    </div>
                    <button class="btn btn-success" onclick="exportSalariesExcel()" style="width: 100%;">
                        ๐ ุชุตุฏูุฑ ุงูุฑูุงุชุจ
                    </button>
                </div>

                <!-- ุชุตุฏูุฑ ุงููุตุฑููุงุช -->
                <div style="background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); text-align: center;">
                    <div style="font-size: 48px; margin-bottom: 15px;">๐ฐ</div>
                    <h3 style="margin-bottom: 10px;">ุชูุฑูุฑ ุงููุตุฑููุงุช</h3>
                    <p style="color: #666; margin-bottom: 20px; font-size: 14px;">ุชุตุฏูุฑ ุฌููุน ุงููุตุฑููุงุช ูุงูููุงุชูุฑ</p>
                    <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px;">
                        <input type="date" id="expense-export-from" placeholder="ูู ุชุงุฑูุฎ" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                        <input type="date" id="expense-export-to" placeholder="ุฅูู ุชุงุฑูุฎ" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;">
                    </div>
                    <button class="btn btn-success" onclick="exportExpensesExcel()" style="width: 100%;">
                        ๐ ุชุตุฏูุฑ ุงููุตุฑููุงุช
                    </button>
                </div>

                <!-- ุชุตุฏูุฑ ุดุงูู -->
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(102,126,234,0.4); text-align: center;">
                    <div style="font-size: 48px; margin-bottom: 15px;">๐</div>
                    <h3 style="margin-bottom: 10px; color: white;">ุงูุชูุฑูุฑ ุงููุงูู ุงูุดุงูู</h3>
                    <p style="color: rgba(255,255,255,0.9); margin-bottom: 20px; font-size: 14px;">ุชูุฑูุฑ ูุงูู: ูุจูุนุงุช - ูุตุฑููุงุช - ุฑูุงุชุจ - ุตุงูู ุงูุฑุจุญ</p>
                    <div style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px;">
                        <input type="date" id="full-export-from" placeholder="ูู ุชุงุฑูุฎ" style="width: 100%; padding: 10px; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; background: rgba(255,255,255,0.2); color: white;">
                        <input type="date" id="full-export-to" placeholder="ุฅูู ุชุงุฑูุฎ" style="width: 100%; padding: 10px; border: 1px solid rgba(255,255,255,0.3); border-radius: 6px; background: rgba(255,255,255,0.2); color: white;">
                    </div>
                    <button class="btn btn-primary" onclick="exportFullFinancialReport()" style="width: 100%; background: white; color: #667eea; font-weight: bold;">
                        ๐ ุชุตุฏูุฑ ุงูุชูุฑูุฑ ุงูุดุงูู
                    </button>
                </div>
            </div>

            <div style="margin-top: 30px; padding: 20px; background: #f9f9f9; border-radius: 8px; text-align: center;">
                <p style="color: #666; margin-bottom: 10px;">๐ก <strong>ููุงุญุธุฉ:</strong> ุฌููุน ุงูุชูุงุฑูุฑ ุชุญุชูู ุนูู:</p>
                <ul style="list-style: none; padding: 0; display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
                    <li>โ ุชูุงุตูู ูุงููุฉ</li>
                    <li>โ ุญุณุงุจุงุช ุชููุงุฆูุฉ</li>
                    <li>โ ุตุงูู ุงูุฑุจุญ</li>
                    <li>โ ุฌุงูุฒ ูููุญุงุณุจูู</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Modal: Add User -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ุฅุถุงูุฉ ูุณุชุฎุฏู ุฌุฏูุฏ</h2>
                <span class="close-modal" onclick="AdminDashboard.closeAddUserModal()">ร</span>
            </div>
            <form id="addUserForm">
                <div class="form-group">
                    <label>ุงูุงุณู ุงููุงูู *</label>
                    <input type="text" id="userFullName" required>
                </div>
                <div class="form-group">
                    <label>ุงุณู ุงููุณุชุฎุฏู *</label>
                    <input type="text" id="userUsername" required>
                </div>
                <div class="form-group">
                    <label>ูููุฉ ุงููุฑูุฑ *</label>
                    <input type="password" id="userPassword" required>
                </div>
                <div class="form-group">
                    <label>ุงูุฏูุฑ *</label>
                    <select id="userRole" required>
                        <option value="">-- ุงุฎุชุฑ --</option>
                        <option value="admin">ูุฏูุฑ</option>
                        <option value="cashier">ูุงุดูุฑ</option>
                        <option value="staff">ููุธู</option>
                        <option value="kitchen">ูุทุจุฎ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ุฑูู ุงูููุจุงูู</label>
                    <input type="tel" id="userPhone">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">ุญูุธ ุงููุณุชุฎุฏู</button>
            </form>
        </div>
    </div>
    <!-- Modal: ุฅุถุงูุฉ ููุธู -->
    <div id="addEmployeeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ุฅุถุงูุฉ ููุธู ุฌุฏูุฏ</h2>
                <span class="close-modal" onclick="closeModal('addEmployeeModal')">ร</span>
            </div>
            <form id="addEmployeeForm" onsubmit="saveEmployee(event)">
                <div class="form-group">
                    <label>ุงุณู ุงูููุธู *</label>
                    <input type="text" id="employeeName" required>
                </div>
                <div class="form-group">
                    <label>ุงููุธููุฉ *</label>
                    <input type="text" id="employeePosition" required>
                </div>
                <div class="form-group">
                    <label>ุงููุงุชู</label>
                    <input type="tel" id="employeePhone">
                </div>
                <div class="form-group">
                    <label>ุงูุฑุงุชุจ ุงููููู *</label>
                    <input type="number" id="employeeSalary" required step="0.01" min="0">
                </div>
                <div class="form-group">
                    <label>ุชุงุฑูุฎ ุงูุชุนููู *</label>
                    <input type="date" id="employeeHireDate" required>
                </div>
                <div class="form-group">
                    <label>ููุงุญุธุงุช</label>
                    <textarea id="employeeNotes" rows="3"></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">ุญูุธ ุงูููุธู</button>
            </form>
        </div>
    </div>

    <!-- Modal: ุฅุถุงูุฉ ููุฑุฏ -->
    <div id="addSupplierModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ุฅุถุงูุฉ ููุฑุฏ ุฌุฏูุฏ</h2>
                <span class="close-modal" onclick="closeModal('addSupplierModal')">ร</span>
            </div>
            <form id="addSupplierForm" onsubmit="saveSupplier(event)">
                <div class="form-group">
                    <label>ุงุณู ุงูููุฑุฏ *</label>
                    <input type="text" id="supplierName" required>
                </div>
                <div class="form-group">
                    <label>ุงููุงุชู</label>
                    <input type="tel" id="supplierPhone">
                </div>
                <div class="form-group">
                    <label>ุงููุฆุฉ</label>
                    <input type="text" id="supplierCategory" placeholder="ูุซุงู: ุฎุถุฑูุงุชุ ูุญููุ ุจูุงูุฉ">
                </div>
                <div class="form-group">
                    <label>ุงูุนููุงู</label>
                    <textarea id="supplierAddress" rows="2"></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">ุญูุธ ุงูููุฑุฏ</button>
            </form>
        </div>
    </div>

    <!-- Modal: ุฅุถุงูุฉ ูุงุชูุฑุฉ -->
    <div id="addInvoiceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ุฅุถุงูุฉ ูุงุชูุฑุฉ ููุฑุฏ</h2>
                <span class="close-modal" onclick="closeModal('addInvoiceModal')">ร</span>
            </div>
            <form id="addInvoiceForm" onsubmit="saveInvoice(event)">
                <div class="form-group">
                    <label>ุงูููุฑุฏ *</label>
                    <select id="invoiceSupplier" required>
                        <option value="">ุงุฎุชุฑ ุงูููุฑุฏ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ุฑูู ุงููุงุชูุฑุฉ</label>
                    <input type="text" id="invoiceNumber" placeholder="ุงุฎุชูุงุฑู">
                </div>
                <div class="form-group">
                    <label>ุงูุชุงุฑูุฎ *</label>
                    <input type="date" id="invoiceDate" required>
                </div>
                <div class="form-group">
                    <label>ุงููุจูุบ ุงูุฅุฌูุงูู *</label>
                    <input type="number" id="invoiceAmount" required step="0.01" min="0" placeholder="0.00">
                </div>
                <div class="form-group">
                    <label>ุงููุจูุบ ุงููุฏููุน</label>
                    <input type="number" id="invoicePaid" step="0.01" min="0" placeholder="0.00">
                </div>
                <div class="form-group">
                    <label>ุงููุตู</label>
                    <textarea id="invoiceDescription" rows="3" placeholder="ุชูุงุตูู ุงููุงุชูุฑุฉ..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">๐พ ุญูุธ ูุทุจุงุนุฉ</button>
            </form>
        </div>
    </div>

    <!-- Modal: ุฅุถุงูุฉ ูุตุฑูู -->
    <div id="addExpenseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ุฅุถุงูุฉ ูุตุฑูู ุนุงู</h2>
                <span class="close-modal" onclick="closeModal('addExpenseModal')">ร</span>
            </div>
            <form id="addExpenseForm" onsubmit="saveExpense(event)">
                <div class="form-group">
                    <label>ููุน ุงููุตุฑูู *</label>
                    <select id="expenseType" required>
                        <option value="">ุงุฎุชุฑ ุงูููุน</option>
                        <option value="electricity">โก ููุฑุจุงุก</option>
                        <option value="water">๐ง ููุงู</option>
                        <option value="internet">๐ ุฅูุชุฑูุช</option>
                        <option value="gas">๐ฅ ุบุงุฒ</option>
                        <option value="rent">๐ ุฅูุฌุงุฑ</option>
                        <option value="maintenance">๐ง ุตูุงูุฉ</option>
                        <option value="other">๐ ุฃุฎุฑู</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ุงูุชุงุฑูุฎ *</label>
                    <input type="date" id="expenseDate" required>
                </div>
                <div class="form-group">
                    <label>ุงููุจูุบ *</label>
                    <input type="number" id="expenseAmount" required step="0.01" min="0" placeholder="0.00">
                </div>
                <div class="form-group">
                    <label>ุงููุฏููุน ุฅูู</label>
                    <input type="text" id="expensePaidTo" placeholder="ุงุณู ุงูุดุฑูุฉ ุฃู ุงูุดุฎุต">
                </div>
                <div class="form-group">
                    <label>ุงููุตู</label>
                    <textarea id="expenseDescription" rows="3" placeholder="ุชูุงุตูู ุงููุตุฑูู..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">๐พ ุญูุธ ูุทุจุงุนุฉ</button>
            </form>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script src="config/keys.js"></script>
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/realtime.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/hr-management.js"></script>
    
    <script>
        window.addEventListener('DOMContentLoaded', () => {
            AdminDashboard.init();
            
            // ุชููุฆุฉ ุงูุชูุงุฑูุฎ
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('attendance-date-picker').value = today;
            document.getElementById('employeeHireDate').value = today;
            document.getElementById('invoiceDate').value = today;
            document.getElementById('expenseDate').value = today;
            
            // ุชุญููู ุงูุจูุงูุงุช ุงูุฃูููุฉ
            if (typeof loadEmployees !== 'undefined') loadEmployees();
            if (typeof loadSuppliers !== 'undefined') loadSuppliers();
        });

        // ===================================
        // ูุธุงุฆู ุงูุชุจููุจุงุช ุงููุฑุนูุฉ
        // ===================================
        
        function switchHRSubTab(tabName) {
            // ุฅุฎูุงุก ุฌููุน ุงูุชุจููุจุงุช ุงููุฑุนูุฉ
            document.querySelectorAll('#hrTab .tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ุฅุฒุงูุฉ active ูู ุงูุฃุฒุฑุงุฑ
            document.querySelectorAll('#hrTab .tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ุฅุธูุงุฑ ุงูุชุจููุจ ุงููุทููุจ
            document.getElementById(tabName + '-subtab').classList.add('active');
            event.target.classList.add('active');
            
            // ุชุญููู ุงูุจูุงูุงุช ุญุณุจ ุงูุชุจููุจ
            if (tabName === 'employees') {
                if (typeof loadEmployees !== 'undefined') loadEmployees();
            } else if (tabName === 'attendance') {
                if (typeof loadAttendance !== 'undefined') loadAttendance();
            } else if (tabName === 'salaries') {
                const today = new Date();
                const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
                document.getElementById('salary-from').value = firstDay.toISOString().split('T')[0];
                document.getElementById('salary-to').value = today.toISOString().split('T')[0];
            }
        }

        function switchExpenseSubTab(tabName) {
            // ุฅุฎูุงุก ุฌููุน ุงูุชุจููุจุงุช ุงููุฑุนูุฉ
            document.querySelectorAll('#expensesTab .tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ุฅุฒุงูุฉ active ูู ุงูุฃุฒุฑุงุฑ
            document.querySelectorAll('#expensesTab .tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // ุฅุธูุงุฑ ุงูุชุจููุจ ุงููุทููุจ
            document.getElementById(tabName + '-subtab').classList.add('active');
            event.target.classList.add('active');
            
            // ุชุญููู ุงูุจูุงูุงุช
            if (tabName === 'suppliers') {
                if (typeof loadSuppliers !== 'undefined') loadSuppliers();
            } else if (tabName === 'invoices') {
                if (typeof loadInvoices !== 'undefined') loadInvoices();
            } else if (tabName === 'general') {
                if (typeof loadGeneralExpenses !== 'undefined') loadGeneralExpenses();
            }
        }

        // ===================================
        // ูุธุงุฆู Modals
        // ===================================
        
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function openAddEmployeeModal() {
            document.getElementById('addEmployeeModal').style.display = 'flex';
            document.getElementById('addEmployeeForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('employeeHireDate').value = today;
        }

        function openAddSupplierModal() {
            document.getElementById('addSupplierModal').style.display = 'flex';
            document.getElementById('addSupplierForm').reset();
        }

        function openAddInvoiceModal() {
            document.getElementById('addInvoiceModal').style.display = 'flex';
            document.getElementById('addInvoiceForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('invoiceDate').value = today;
            
            // ุชุญููู ูุงุฆูุฉ ุงูููุฑุฏูู
            if (typeof loadSuppliersForInvoice !== 'undefined') {
                loadSuppliersForInvoice();
            }
        }

        function openAddExpenseModal() {
            document.getElementById('addExpenseModal').style.display = 'flex';
            document.getElementById('addExpenseForm').reset();
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('expenseDate').value = today;
        }

        // ุฅุบูุงู Modal ุนูุฏ ุงูุถุบุท ุฎุงุฑุฌูุง
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }
    </script>

    <!-- ===================================
         ูุธุงู Refresh ูุงูุงุชุตุงู ุงูุฐูู
         =================================== -->
    <style>
      .refresh-widget {
        position: fixed;
        bottom: 30px;
        right: 30px;
        display: flex;
        flex-direction: column;
        gap: 10px;
        z-index: 9998;
      }

      .refresh-btn-main {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 50%;
        color: white;
        font-size: 26px;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
      }

      .refresh-btn-main:hover {
        transform: scale(1.1) rotate(15deg);
        box-shadow: 0 6px 25px rgba(102, 126, 234, 0.7);
      }

      .refresh-btn-main.refreshing {
        animation: rotate360 1s linear infinite;
      }

      @keyframes rotate360 {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
      }

      .refresh-badge {
        position: absolute;
        top: -5px;
        right: -5px;
        background: #f44336;
        color: white;
        width: 22px;
        height: 22px;
        border-radius: 50%;
        font-size: 11px;
        font-weight: bold;
        display: none;
        align-items: center;
        justify-content: center;
        border: 2px solid white;
      }

      .refresh-badge.show {
        display: flex;
      }

      .connection-status {
        background: white;
        padding: 10px 15px;
        border-radius: 25px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
        font-weight: 600;
      }

      .connection-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        animation: pulse-dot 2s infinite;
      }

      .connection-status.connected .connection-dot {
        background: #4caf50;
      }

      .connection-status.disconnected .connection-dot {
        background: #f44336;
      }

      @keyframes pulse-dot {
        0%, 100% { box-shadow: 0 0 0 0 rgba(76, 175, 80, 0.7); }
        50% { box-shadow: 0 0 0 6px rgba(76, 175, 80, 0); }
      }

      @media (max-width: 768px) {
        .refresh-widget {
          bottom: 20px;
          right: 20px;
        }
        .refresh-btn-main {
          width: 50px;
          height: 50px;
        }
      }
    </style>

    <div class="refresh-widget">
      <button class="refresh-btn-main" id="refreshBtn" onclick="refreshData()" title="ุชุญุฏูุซ ุงูุจูุงูุงุช">
        ๐
        <span class="refresh-badge" id="refreshBadge">0</span>
      </button>
      
      <div class="connection-status checking" id="connectionStatus">
        <span class="connection-dot"></span>
        <span id="connectionText">ุฌุงุฑู ุงููุญุต...</span>
      </div>
    </div>

    <script>
    let isRefreshing = false;

    async function checkConnection() {
      const statusElement = document.getElementById('connectionStatus');
      const textElement = document.getElementById('connectionText');
      
      try {
        const { error } = await supabase.from('orders').select('id').limit(1);
        if (error) throw error;
        
        statusElement.className = 'connection-status connected';
        textElement.textContent = 'ูุชุตู';
        return true;
      } catch (error) {
        statusElement.className = 'connection-status disconnected';
        textElement.textContent = 'ุบูุฑ ูุชุตู';
        return false;
      }
    }

    async function refreshData() {
      if (isRefreshing) return;
      
      isRefreshing = true;
      const btn = document.getElementById('refreshBtn');
      btn.classList.add('refreshing');
      
      try {
        if (typeof AdminDashboard !== 'undefined' && AdminDashboard.loadAllData) {
          await AdminDashboard.loadAllData();
        }
        await checkConnection();
      } catch (error) {
        console.error('Refresh error:', error);
      } finally {
        isRefreshing = false;
        btn.classList.remove('refreshing');
      }
    }

    window.addEventListener('DOMContentLoaded', async () => {
      await checkConnection();
      setInterval(checkConnection, 30000);
      setInterval(refreshData, 2 * 60 * 1000);
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'F5' || (e.ctrlKey && e.key === 'r')) {
        e.preventDefault();
        refreshData();
      }
    });
    </script>
</body>
</html>
