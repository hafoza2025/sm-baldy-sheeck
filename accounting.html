<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุธุงู ุงููุญุงุณุจุฉ | ูุทุนู ุงููุฑุนูู</title>
    <link rel="stylesheet" href="css/shared.css">
    <link rel="stylesheet" href="css/accounting.css">
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="main-header">
        <div class="header-content">
            <div class="logo">๐๏ธ ูุธุงู ุงููุญุงุณุจุฉ</div>
            <div class="header-actions">
                <button class="btn btn-primary" onclick="exportAllToExcel()">
                    ๐ ุชุตุฏูุฑ Excel ุดุงูู
                </button>
                <button class="btn btn-info" onclick="showFinancialSummary()">
                    ๐ฐ ุงูููุฎุต ุงููุงูู
                </button>
                <span class="user-name" id="userName"></span>
                <button class="btn btn-secondary" onclick="logout()">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="accounting-container">
        
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-section="dashboard" onclick="showSection('dashboard')">
                    <span class="icon">๐</span>
                    <span>ููุญุฉ ุงูุชุญูู</span>
                </a>
                <a href="#" class="nav-item" data-section="employees" onclick="showSection('employees')">
                    <span class="icon">๐ฅ</span>
                    <span>ุงูููุธููู</span>
                </a>
                <a href="#" class="nav-item" data-section="attendance" onclick="showSection('attendance')">
                    <span class="icon">๐</span>
                    <span>ุงูุญุถูุฑ ูุงูุบูุงุจ</span>
                </a>
                <a href="#" class="nav-item" data-section="payroll" onclick="showSection('payroll')">
                    <span class="icon">๐ต</span>
                    <span>ุงูุฑูุงุชุจ</span>
                </a>
                <a href="#" class="nav-item" data-section="suppliers" onclick="showSection('suppliers')">
                    <span class="icon">๐ญ</span>
                    <span>ุงูููุฑุฏูู</span>
                </a>
                <a href="#" class="nav-item" data-section="invoices" onclick="showSection('invoices')">
                    <span class="icon">๐</span>
                    <span>ููุงุชูุฑ ุงูููุฑุฏูู</span>
                </a>
                <a href="#" class="nav-item" data-section="expenses" onclick="showSection('expenses')">
                    <span class="icon">๐ณ</span>
                    <span>ุงููุตุฑููุงุช ุงูุนุงูุฉ</span>
                </a>
                <a href="#" class="nav-item" data-section="contracts" onclick="showSection('contracts')">
                    <span class="icon">๐</span>
                    <span>ุงูุนููุฏ</span>
                </a>
                <a href="#" class="nav-item" data-section="reports" onclick="showSection('reports')">
                    <span class="icon">๐</span>
                    <span>ุงูุชูุงุฑูุฑ</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">

            <!-- Dashboard Section -->
            <section id="dashboard-section" class="content-section active">
                <h2 class="section-title">ููุญุฉ ุงูุชุญูู ุงููุงููุฉ</h2>
                
                <!-- Date Filter -->
                <div class="filter-container">
                    <div class="filter-group">
                        <label>ุงููุชุฑุฉ:</label>
                        <select id="periodFilter" onchange="AccountingSystem.applyFilter()">
                            <option value="today">ุงูููู</option>
                            <option value="week" selected>ูุฐุง ุงูุฃุณุจูุน</option>
                            <option value="month">ูุฐุง ุงูุดูุฑ</option>
                            <option value="custom">ูุฎุตุต</option>
                        </select>
                    </div>
                    <div class="filter-group" id="customDateGroup" style="display: none;">
                        <input type="date" id="startDate">
                        <span>ุฅูู</span>
                        <input type="date" id="endDate">
                        <button class="btn btn-sm btn-primary" onclick="AccountingSystem.applyFilter()">ุชุทุจูู</button>
                    </div>
                </div>

                <!-- Financial Summary Cards -->
                <div class="stats-grid">
                    <div class="stat-card revenue">
                        <div class="stat-icon">๐ฐ</div>
                        <div class="stat-info">
                            <h3>ุฅุฌูุงูู ุงููุจูุนุงุช</h3>
                            <p class="stat-value" id="totalRevenue">0 ุฌ.ู</p>
                            <span class="stat-period" id="revenuePeriod"></span>
                        </div>
                    </div>

                    <div class="stat-card expenses">
                        <div class="stat-icon">๐ธ</div>
                        <div class="stat-info">
                            <h3>ุฅุฌูุงูู ุงููุตุฑููุงุช</h3>
                            <p class="stat-value" id="totalExpenses">0 ุฌ.ู</p>
                            <span class="stat-period" id="expensesPeriod"></span>
                        </div>
                    </div>

                    <div class="stat-card profit">
                        <div class="stat-icon">๐</div>
                        <div class="stat-info">
                            <h3>ุตุงูู ุงูุฑุจุญ</h3>
                            <p class="stat-value" id="netProfit">0 ุฌ.ู</p>
                            <span class="stat-period" id="profitPeriod"></span>
                        </div>
                    </div>

                    <div class="stat-card employees-cost">
                        <div class="stat-icon">๐ฅ</div>
                        <div class="stat-info">
                            <h3>ุชูููุฉ ุงูููุธููู</h3>
                            <p class="stat-value" id="employeesCost">0 ุฌ.ู</p>
                            <span class="stat-period"></span>
                        </div>
                    </div>
                </div>

                <!-- Expenses Breakdown -->
                <div class="breakdown-container">
                    <div class="breakdown-card">
                        <h3>ุชูุตูู ุงููุตุฑููุงุช</h3>
                        <div class="breakdown-list" id="expensesBreakdown"></div>
                    </div>

                    <div class="breakdown-card">
                        <h3>ุฃุนูู ุงูููุฑุฏูู</h3>
                        <div class="breakdown-list" id="topSuppliers"></div>
                    </div>
                </div>

                <!-- Recent Transactions -->
                <div class="recent-transactions">
                    <h3>ุขุฎุฑ ุงูุนูููุงุช</h3>
                    <div class="table-responsive">
                        <table class="data-table" id="recentTransactionsTable">
                            <thead>
                                <tr>
                                    <th>ุงูุชุงุฑูุฎ</th>
                                    <th>ุงูููุน</th>
                                    <th>ุงููุตู</th>
                                    <th>ุงููุจูุบ</th>
                                    <th>ุงูุญุงูุฉ</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Employees Section -->
            <section id="employees-section" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">ุฅุฏุงุฑุฉ ุงูููุธููู</h2>
                    <button class="btn btn-primary" onclick="AccountingSystem.showAddEmployeeModal()">
                        โ ุฅุถุงูุฉ ููุธู
                    </button>
                </div>

                <div class="table-responsive">
                    <table class="data-table" id="employeesTable">
                        <thead>
                            <tr>
                                <th>ุงูุตูุฑุฉ</th>
                                <th>ุงูุงุณู</th>
                                <th>ุงููุธููุฉ</th>
                                <th>ุงููุณู</th>
                                <th>ุงูุฑุงุชุจ ุงููููู</th>
                                <th>ุงูุฑุงุชุจ ุงูุดูุฑู</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Attendance Section -->
            <section id="attendance-section" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">ุงูุญุถูุฑ ูุงูุบูุงุจ</h2>
                    <button class="btn btn-primary" onclick="AccountingSystem.showAttendanceModal()">
                        โ ุชุณุฌูู ุญุถูุฑ
                    </button>
                </div>

                <div class="attendance-calendar" id="attendanceCalendar"></div>

                <div class="table-responsive">
                    <table class="data-table" id="attendanceTable">
                        <thead>
                            <tr>
                                <th>ุงูุชุงุฑูุฎ</th>
                                <th>ุงูููุธู</th>
                                <th>ููุช ุงูุฏุฎูู</th>
                                <th>ููุช ุงูุฎุฑูุฌ</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Payroll Section -->
            <section id="payroll-section" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">ุฅุฏุงุฑุฉ ุงูุฑูุงุชุจ</h2>
                    <button class="btn btn-primary" onclick="AccountingSystem.showPayrollModal()">
                        ๐ต ุฅูุดุงุก ูุดู ุฑุงุชุจ
                    </button>
                </div>

                <div class="table-responsive">
                    <table class="data-table" id="payrollTable">
                        <thead>
                            <tr>
                                <th>ุงูุดูุฑ</th>
                                <th>ุงูููุธู</th>
                                <th>ุฃูุงู ุงูุนูู</th>
                                <th>ุงูุฃุณุงุณู</th>
                                <th>ุงูุฎุตููุงุช</th>
                                <th>ุงูุจููุต</th>
                                <th>ุงูุตุงูู</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Suppliers Section -->
            <section id="suppliers-section" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">ุฅุฏุงุฑุฉ ุงูููุฑุฏูู</h2>
                    <button class="btn btn-primary" onclick="AccountingSystem.showAddSupplierModal()">
                        โ ุฅุถุงูุฉ ููุฑุฏ
                    </button>
                </div>

                <div class="table-responsive">
                    <table class="data-table" id="suppliersTable">
                        <thead>
                            <tr>
                                <th>ุงูุงุณู</th>
                                <th>ุงูุดุฑูุฉ</th>
                                <th>ุงููุฆุฉ</th>
                                <th>ุงููุงุชู</th>
                                <th>ุงูุฑุตูุฏ ุงูุญุงูู</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Supplier Invoices Section -->
            <section id="invoices-section" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">ููุงุชูุฑ ุงูููุฑุฏูู</h2>
                    <button class="btn btn-primary" onclick="AccountingSystem.showAddInvoiceModal()">
                        โ ุฅุถุงูุฉ ูุงุชูุฑุฉ
                    </button>
                </div>

                <div class="table-responsive">
                    <table class="data-table" id="invoicesTable">
                        <thead>
                            <tr>
                                <th>ุฑูู ุงููุงุชูุฑุฉ</th>
                                <th>ุงูููุฑุฏ</th>
                                <th>ุงูุชุงุฑูุฎ</th>
                                <th>ุงูุฅุฌูุงูู</th>
                                <th>ุงููุฏููุน</th>
                                <th>ุงููุชุจูู</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- General Expenses Section -->
            <section id="expenses-section" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">ุงููุตุฑููุงุช ุงูุนุงูุฉ</h2>
                    <button class="btn btn-primary" onclick="AccountingSystem.showAddExpenseModal()">
                        โ ุฅุถุงูุฉ ูุตุฑูู
                    </button>
                </div>

                <div class="expenses-categories">
                    <button class="category-btn active" data-type="all" onclick="AccountingSystem.filterExpenses('all')">ุงููู</button>
                    <button class="category-btn" data-type="electricity" onclick="AccountingSystem.filterExpenses('electricity')">โก ููุฑุจุงุก</button>
                    <button class="category-btn" data-type="water" onclick="AccountingSystem.filterExpenses('water')">๐ง ููุงู</button>
                    <button class="category-btn" data-type="internet" onclick="AccountingSystem.filterExpenses('internet')">๐ ุฅูุชุฑูุช</button>
                    <button class="category-btn" data-type="gas" onclick="AccountingSystem.filterExpenses('gas')">๐ฅ ุบุงุฒ</button>
                    <button class="category-btn" data-type="rent" onclick="AccountingSystem.filterExpenses('rent')">๐ข ุฅูุฌุงุฑ</button>
                    <button class="category-btn" data-type="maintenance" onclick="AccountingSystem.filterExpenses('maintenance')">๐ง ุตูุงูุฉ</button>
                    <button class="category-btn" data-type="other" onclick="AccountingSystem.filterExpenses('other')">๐ ุฃุฎุฑู</button>
                </div>

                <div class="table-responsive">
                    <table class="data-table" id="expensesTable">
                        <thead>
                            <tr>
                                <th>ุงูุชุงุฑูุฎ</th>
                                <th>ุงูููุน</th>
                                <th>ุงููุตู</th>
                                <th>ุงููุจูุบ</th>
                                <th>ุทุฑููุฉ ุงูุฏูุน</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Contracts Section -->
            <section id="contracts-section" class="content-section">
                <div class="section-header">
                    <h2 class="section-title">ุฅุฏุงุฑุฉ ุงูุนููุฏ</h2>
                    <button class="btn btn-primary" onclick="AccountingSystem.showCreateContractModal()">
                        โ ุฅูุดุงุก ุนูุฏ
                    </button>
                </div>

                <div class="table-responsive">
                    <table class="data-table" id="contractsTable">
                        <thead>
                            <tr>
                                <th>ุฑูู ุงูุนูุฏ</th>
                                <th>ุงูููุน</th>
                                <th>ุงูุนููุงู</th>
                                <th>ุงูุทุฑู</th>
                                <th>ุงููุจูุบ</th>
                                <th>ุงูุญุงูุฉ</th>
                                <th>ุงูุฅุฌุฑุงุกุงุช</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- Reports Section -->
            <section id="reports-section" class="content-section">
                <h2 class="section-title">ุงูุชูุงุฑูุฑ ูุงูุฅุญุตุงุฆูุงุช</h2>

                <div class="reports-grid">
                    <div class="report-card" onclick="AccountingSystem.generateEmployeeReport()">
                        <div class="report-icon">๐ฅ</div>
                        <h3>ุชูุฑูุฑ ุงูููุธููู</h3>
                        <p>ุชูุฑูุฑ ุดุงูู ุจุงูููุธููู ูุงูุญุถูุฑ ูุงูุฑูุงุชุจ</p>
                    </div>

                    <div class="report-card" onclick="AccountingSystem.generateExpensesReport()">
                        <div class="report-icon">๐ธ</div>
                        <h3>ุชูุฑูุฑ ุงููุตุฑููุงุช</h3>
                        <p>ุชุญููู ุชูุตููู ููุงูุฉ ุงููุตุฑููุงุช</p>
                    </div>

                    <div class="report-card" onclick="AccountingSystem.generateSuppliersReport()">
                        <div class="report-icon">๐ญ</div>
                        <h3>ุชูุฑูุฑ ุงูููุฑุฏูู</h3>
                        <p>ุชูุฑูุฑ ุงูููุฑุฏูู ูุงูููุงุชูุฑ ูุงููุณุชุญูุงุช</p>
                    </div>

                    <div class="report-card" onclick="AccountingSystem.generateProfitLossReport()">
                        <div class="report-icon">๐</div>
                        <h3>ุงูุฃุฑุจุงุญ ูุงูุฎุณุงุฆุฑ</h3>
                        <p>ุชูุฑูุฑ ููุตู ุจุงูุฅูุฑุงุฏุงุช ูุงููุตุฑููุงุช</p>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- Modals will be injected here -->
    <div id="modalContainer"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>ุฌุงุฑู ุงูุชุญููู...</p>
    </div>

    <!-- Scripts -->
    <script src="config/keys.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/accounting.js"></script>
    <script>
        // Initialize system on page load
        document.addEventListener('DOMContentLoaded', () => {
            AccountingSystem.init();
        });

        // Navigation
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });

            // Show selected section
            document.getElementById(`${sectionName}-section`).classList.add('active');

            // Update nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`[data-section="${sectionName}"]`).classList.add('active');
        }

        // Logout
        function logout() {
            localStorage.removeItem('authToken');
            window.location.href = 'index.html';
        }
    </script>
</body>
</html>

